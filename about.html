<!DOCTYPE html>
<html>
  <head>

    <title>About Me</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="site.css">

    <script src="https://storage.googleapis.com/feednami-static/js/feednami-client-v1.0.1.js">
    </script>

    <script>
          window.onload = function() {
            // functions that run after page loads
            displayGreeting();
            fetchWeather();
            displayRSSFeed();
          }
          // display good morning, afternoon or evening based on the time
          function displayGreeting() {
            var date = new Date();
            var hour = date.getHours();
            var description = "";
            if (hour < 12) {
              description = "morning!";
            } else if (hour < 17) {
              description = "afternoon!";
            } else {
              description = "evening!";
            }
            document.getElementById("greeting").innerHTML = "Good " + description;
          }

          // get weather data from openweathermap and display the current temp
          function fetchWeather() {
            fetch("https://api.openweathermap.org/data/2.5/weather?zip=85716,US&appid=fa4e183ab0f9b88719c98b921fcb8e64&units=imperial")
            .then(function(resp) { return resp.json() })
            .then(function(data) {
              document.getElementById("weather").innerHTML = "It is currently " + data.main.temp + "&#176;" + " in Tucson, AZ.";
            })
            .catch(function() {
              document.getElementById("weather").innerHTML = "Error in fetchWeather function";
            });
          }

        function displayRSSFeed() {
        // fetch an RSS feed and display the title and description
        var origURL = 'https://tucson.com/search/?f=rss&t=article&c=news/local&l=25&s=start_time&sd=desc';
        // feednami doesn't like & so replace with %26
        var replacedURL = origURL.replace(/&/g, "%26");
        feednami.load(replacedURL,function(result) {
          if (result.error) {
            console.log(result.error);
          } else {
            var entries = result.feed.entries
            for (var i = 0; i < entries.length; i++) {
              var entry = entries[i];
              let divElement = '<div class="rss_title"><a href="' + entry.link + '" target="_blank">' + entry.title + '</a></div><div class="rss_description">' + entry.description + '</div>';
              document.getElementById("rss_items").innerHTML += divElement;
            }
          }
        });
      }

      </script>

  </head>


  <body>
    <center>
    <div id="greeting"></div>
    <div id="weather"></div>
    </center>
    <center>
      <div class="name_container">
        Brett Fera
      </div>

      <div class="content_container">

      <div class="image_container">
        <img src="media/mayhem.jpg" alt=Mayhem, the beagle!>
      </div>

      <div class="bio_container">
        Originally from Los Angeles, Tucson has been my on- and off- and on-again home for 20 years now. With degrees in journalism (B.A. 2005) and business (M.B.A. 2010) from the University of Arizona, I consider myself immensely privileged to be able to work each day with hundreds of dedicated students as director of Arizona Student Media – the UA department that oversees and supports the operation of the 121-year-old Arizona Daily Wildcat, UATV-3 student television, and KAMP Student Radio. I live near campus with my wife, Lindsey (also a UA alumna and my favorite on-campus coworker!) and our beagle, Mayhem (he’s actually sweet and well-behaved, and rarely lives up to his name).
      </div>

      <div class="clear"></div>

      </div>

      <div class="news_container">
        <div class="newstitle">News Sites</div>
        <div class="newssite"><a href="https://tucson.com" target="_blank">Arizona Daily Star</a></div>
        <div class="newssite"><a href="https://azpm.org/" target="_blank">AZPM</a></div>
        <div class="newssite"><a href="https://dailywildcat.com" target="_blank">The Daily Wildcat</a></div>
        <div class="newssite"><a href="https://tucsonsentinel.com/" target="_blank">Tucson Sentinel</a></div>
        <div class="newssite"><a href="https://kvoa.com/" target="_blank">KVOA</a></div>
        <div class="newssite"><a href="https://www.kgun9.com/" target="_blank">KGUN</a></div>

      <div class="clear"></div>

      </div>

    </center>

    <div id="rss_items"></div>



  </body>
  </html>
